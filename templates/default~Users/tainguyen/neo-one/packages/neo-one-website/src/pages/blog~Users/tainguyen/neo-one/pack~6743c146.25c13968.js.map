{"version":3,"sources":["webpack:///Helmet.tsx","webpack:///PrismSetup.ts","webpack:///markdownTOC.ts","webpack:///Markdown.tsx"],"names":["Helmet","title","description","children","props","meta","name","content","itemprop","property","concat","undefined","window","_WorkerGlobalScope","WorkerGlobalScope","self","Prism","languages","typescript","extend","keyword","keywordBlue","builtin","ts","util","clone","tsx","PrismSetup","defaults","includeLevel","containerClass","slugify","s","encodeURIComponent","String","trim","toLowerCase","replace","markerPattern","listType","format","forceFullToc","subTOC","containerHeaderHtml","containerFooterHtml","markdownTOC","md","o","options","Object","assign","tocRegexp","gstate","seen","open","body","close","renderChildsTokens","pos","tokens","currentLevel","subHeadings","headings","buffer","size","length","i","token","heading","level","tag","parseInt","substr","type","indexOf","push","join","renderer","rules","tocOpenHtml","tocFooterHtml","tocBody","tokenLength","tocHierarchy","result","core","ruler","state","inline","after","silent","match","src","charCodeAt","exec","filter","m","markup","newline","posMax","createMD","withAnchors","set","html","xhtmlOut","breaks","langPrefix","linkify","typographer","quotes","highlight","text","lang","classAttribute","utils","escapeHtml","use","render","slice","idx","a","mdWithoutAnchors","mdWithAnchors","headerMargins","stretchCSS","Wrapper","light","theme","gray1","black","primary","accent","gray","ref","this","handleUpdate","resetScroll","scrollTo","prevProps","source","linkColor","anchors","dangerouslySetInnerHTML","__html","current","highlightAllUnder","getElementsByTagName","openAllLinksInNewTab","host","location","target"],"mappings":"+JAUO,MAAMA,EAAU,I,IAAA,MAAEC,EAAF,YAASC,EAAT,SAAsBC,GAAQ,EAAKC,EAAK,mBAAxC,oCAAsD,OAC3E,kBAAC,OAAI,eACHH,MAAOA,GACHG,EAAK,CACTC,KAAM,CACJ,CAAEC,KAAM,gBAAiBC,QAASN,GAElC,CAAEO,SAAU,OAAQD,QAASN,GAC7B,CAAEQ,SAAU,WAAYF,QAASN,GAEjC,CAAEO,SAAU,QAASD,QAAS,iCAC9B,CAAED,KAAM,oBAAqBC,QAAS,iCACtC,CAAEE,SAAU,WAAYF,QAAS,iCACjC,CAAED,KAAM,eAAgBC,QAAS,WACjC,CAAED,KAAM,eAAgBC,QAAS,kBACjC,CAAEE,SAAU,SAAUF,QAAS,sBAC/B,CAAEE,SAAU,eAAgBF,QAAS,WACrC,CAAEE,SAAU,UAAWF,QAAS,YAChCG,YACgBC,IAAhBT,EACI,GACA,CACE,CAAEI,KAAM,cAAeC,QAASL,GAEhC,CAAEM,SAAU,cAAeD,QAASL,GACpC,CAAEO,SAAU,iBAAkBF,QAASL,GACvC,CAAEI,KAAM,sBAAuBC,QAASL,OAI/CC,K,uDCxCL,yGAEsB,oBAAXS,QACT,EAAQ,KAKV,MAAMC,EAAkD,oBAAtBC,uBAAoCH,EAAYG,mBAG9D,oBAAXF,OACHA,YAEqBD,IAAvBE,GAAoCE,gBAAgBF,EAClDE,KACA,IACAC,MAAQ,IAGQ,oBAAXJ,QACT,EAAQ,KAYV,IAAMK,UAAUC,WAAa,IAAMD,UAAUE,OAAO,aAAc,CAEhEC,QAAS,0KACTC,YAAa,wNACbC,QAAS,8EAEX,IAAML,UAAUM,GAAK,IAAMN,UAAUC,WACrC,MAAMA,EAAa,IAAMM,KAAKC,MAAM,IAAMR,UAAUC,YACpD,IAAMD,UAAUS,IAAM,IAAMT,UAAUE,OAAO,MAAOD,GAG7C,MAAMS,EAAa,K,wMC1C1B,MACMC,EAAW,CACfC,aAAc,CAAC,EAAG,GAClBC,eAAgB,oBAChBC,QAJeC,GAAWC,mBAAmBC,OAAOF,GAAGG,OAAOC,cAAcC,QAAQ,OAAQ,MAK5FC,cAAe,iBACfC,SAAU,KACVC,YAAQ7B,EACR8B,cAAc,EACdC,QAAQ,EACRC,yBAAqBhC,EACrBiC,yBAAqBjC,EACrBL,KAAM,OAGKuC,EAAc,CAACC,EAASC,KACnC,MAAMC,EAAUC,OAAOC,OAAO,GAAItB,EAAUmB,GACtCzC,EAAO0C,EAAQ1C,KACf6C,EAAYH,EAAQV,cAC1B,IAAIc,EACAC,EAAO,EAEX,MAAMC,EAAUhD,EAAH,QACPiD,EAAUjD,EAAH,QACPkD,EAAWlD,EAAH,SAqGd,SAASmD,EAAmBC,EAAUC,GAOpC,IANA,IAEEC,EACAC,EAHEC,EAAW,GACbC,EAAS,GAGTC,EAAOL,EAAOM,OACdC,EAAIR,EACCQ,EAAIF,GAAM,CACf,IAAIG,EAAQR,EAAOO,GACfE,EAAUT,EAAOO,EAAI,GACrBG,EAAQF,EAAMG,KAAOC,SAASJ,EAAMG,IAAIE,OAAO,EAAG,IACtD,GACiB,kBAAfL,EAAMM,OACkC,GAAxCzB,EAAQnB,aAAa6C,QAAQL,SACZ1D,IAAjBiD,GACAZ,EAAQN,OAER,MAEF,GAAmB,kBAAfyB,EAAMM,OAAoE,GAAxCzB,EAAQnB,aAAa6C,QAAQL,IAAiC,WAAjBD,EAAQK,KAA3F,CAIA,GAAKb,EAEE,CACL,GAAIS,EAAQT,EAAc,CAExBG,IADAF,EAAcJ,EAAmBS,EAAGP,IACd,GACtBO,EAAIL,EAAY,GAChB,SAEF,GAAIQ,EAAQT,EAIV,OAFAG,GAAU,QACVD,EAASa,KAAKZ,GACP,CAACG,EAAG,IAAIlB,EAAQT,YAAYuB,EAASc,KAAK,QAAQ5B,EAAQT,aAE/D8B,GAAST,IAEXG,GAAU,QACVD,EAASa,KAAKZ,SAjBhBH,EAAeS,EAoBjBN,EAAS,iBAAiBf,EAAQjB,QAAQqC,EAAQ7D,aAClDwD,GAAoC,mBAAnBf,EAAQR,OAAwBQ,EAAQR,OAAO4B,EAAQ7D,SAAW6D,EAAQ7D,QAC3FwD,GAAU,OACVG,SA3BEA,IA+BJ,OAFAH,GAAqB,KAAXA,EAAgB,GAAK,QAC/BD,EAASa,KAAKZ,GACP,CAACG,EAAG,IAAIlB,EAAQT,YAAYuB,EAASc,KAAK,QAAQ5B,EAAQT,aA1GnEO,EAAG+B,SAASC,MAAMxB,GAAQ,WACxB,IAAIyB,EAAc,eAAe/B,EAAQlB,mBAMzC,OAJIkB,EAAQL,sBACVoC,GAAe/B,EAAQL,qBAGlBoC,GAGTjC,EAAG+B,SAASC,MAAMtB,GAAS,WACzB,IAAIwB,EAAgB,GAMpB,OAJIhC,EAAQJ,sBACVoC,EAAgBhC,EAAQJ,qBAGnBoC,EAAgB,UAGzBlC,EAAG+B,SAASC,MAAMvB,GAAQ,WACxB,GAAIP,EAAQP,aAAc,CAoBxB,IAJA,IAAIwC,EAAU,GACVvB,EAAM,EACNwB,EAAc9B,GAAUA,EAAOO,QAAUP,EAAOO,OAAOM,OAEpDP,EAAMwB,GAAa,CACxB,IAAIC,EAAe1B,EAAmBC,EAAKN,EAAOO,QAClDD,EAAMyB,EAAa,GACnBF,GAAWE,EAAa,GAG1B,OAAOF,EACF,CACL,MAAMG,EAAS3B,EAAmBJ,EAAMD,EAAOO,QAE/C,OADAN,EAAO+B,EAAO,GAAK,EACZA,EAAO,KA2DlBtC,EAAGuC,KAAKC,MAAMX,KAAK,cAAc,SAAUY,QAC1B5E,IAAXyC,IACFA,EAASmC,MAKbzC,EAAG0C,OAAOF,MAAMG,MAAM,WAAY,OAjKlC,SAAaF,EAAYG,GACvB,IACIC,EAGJ,GAAwC,KAApCJ,EAAMK,IAAIC,WAAWN,EAAM7B,KAC7B,OAAO,EAGT,GAAIgC,EACF,OAAO,EAUT,IALAC,GADAA,EAAQxC,EAAU2C,KAAKP,EAAMK,IAAIpB,OAAOe,EAAM7B,OAG1CiC,EAAMI,QAAO,SAAUC,GACrB,OAAOA,KAFT,IAIM/B,OAAS,EACjB,OAAO,EAGTb,OAASzC,EACT0C,EAAO,EAGCkC,EAAMZ,KAAKrB,EAAM,MAAO,GAC1B2C,OAAS,UACPV,EAAMZ,KAAKpB,EAAM,GAAI,GACrBgC,EAAMZ,KAAKnB,EAAO,OAAQ,GAGlC,IAAI0C,EAAUX,EAAMK,IAAIlB,QAAQ,KAAMa,EAAM7B,KAO5C,OALE6B,EAAM7B,KADS,IAAbwC,EACUA,EAEAX,EAAM7B,IAAM6B,EAAMY,OAAS,GAGlC,MCvDX,MAEMC,EAAW,EAAGC,kBAClB,MAAMvD,EAAK,MA+CX,OA9CAA,EAAGwD,IAAI,CACLC,MAAM,EACNC,UAAU,EACVC,QAAQ,EACRC,WARe,YASfC,SAAS,EACTC,aAAa,EACbC,OAAQ,SACRC,UAAW,CAACC,EAAMC,KAChB,MACMC,EAAiBD,EAAO,oBAAwBA,KAAU,GAEhE,MAAO,OAAOC,UAAuBA,KAHxBnE,EAAGoE,MAAMC,WAAWJ,qBAMlCK,IAAIvE,EAAa,CAChBd,QAAA,IACAF,aAAc,CAAC,GACfvB,KAAM,QAEP8G,IAAIvE,EAAa,CAChBd,QAAA,IACAO,cAAe,2BACfE,OAASjC,GAAoBuC,EAAGuE,OAAO9G,GAAS+G,MAAM,GAAI,GAC1DzF,aAAc,CAAC,EAAG,GAClBvB,KAAM,gBACNoC,QAAQ,IAET0E,IAAI,IAAW,UAAW,CAEzBC,OAAQ,CAAC1D,EAAa4D,IACK,2BAArB5D,EAAO4D,GAAK9C,KACP,+BAGF,oBAIT4B,GACFvD,EAAGsE,IAAI,EAAAI,EAAQ,CACbzF,QAAA,IACAsC,MAAO,CAAC,EAAG,EAAG,EAAG,KAIdvB,GAGH2E,EAAmBrB,EAAS,CAAEC,aAAa,IAC3CqB,EAAgBtB,EAAS,CAAEC,aAAa,IAExCsB,EAAgB,CAAH,6DAmBbC,EAAa,CAAH,8DAKVC,EAAU,mBAAH,oBAAG,CACZ,eAAK,+BADI,IAET,eAAK,4BAFI,kCAMP,eAAK,6BANE,6CAYP,eAAK,6BAZE,IAaPF,EAbO,UAiBP,eAAK,6BAjBE,IAkBPA,EAlBO,UAsBP,eAAK,+BAtBE,IAuBPA,EAvBO,UA2BP,eAAK,+BA3BE,IA4BPA,EA5BO,UAgCP,eAAK,0BAhCE,IAiCPA,EAjCO,oDAlBWvH,GAClBA,EAAM0H,MACD,cAAP,oBACsB1H,EAAM2H,MAAMC,MADlC,UAEW5H,EAAM2H,MAAME,MAFvB,mCAQK,GAQI,IA2CP,eAAK,+BA3CE,yKAwDA,qBAAW,YAAa,CAC/BC,QAAS,eAAK,iBACdC,OAAQ,eAAK,gBACbC,KAAM,eAAK,iBA3DJ,IA6DP,eAAK,4BA7DE,IA8DP,eAAK,+BA9DE,yCAoEA,qBAAW,YAAa,CAC/BF,QAAS,eAAK,iBACdC,OAAQ,eAAK,gBACbC,KAAM,eAAK,iBAvEJ,qBA4EA,eAAK,qBA5EL,+CAiFA,eAAK,qBAjFL,qBAqFA,eAAK,qBArFL,+CA0FA,eAAK,qBA1FL,sBA8FA,eAAK,qBA9FL,gDAmGA,eAAK,qBAnGL,kHA6GM,eAAK,mCA7GX,mkBA2JPR,EA3JO,+FAoKP,eAAK,4BApKE,0DAwLP,MAAO,UAAiB,YAA9B,c,oBACmB,KAAAS,IAAM,cAEhB,oBACLC,KAAKC,eACDD,KAAKlI,MAAMoI,aACb5H,OAAO6H,SAAS,EAAG,GAIhB,mBAAmBC,GACxBJ,KAAKC,eACDD,KAAKlI,MAAMoI,aAAeF,KAAKlI,MAAMuI,SAAWD,EAAUC,QAC5D/H,OAAO6H,SAAS,EAAG,GAIhB,SACL,MAAM,EAA8EH,KAAKlI,OAAnF,OAAEuI,EAAF,UAAUC,EAAY,UAAtB,MAAiCd,GAAQ,EAAzC,QAAgDe,GAAU,GAAK,EAAKzI,EAAK,mBAAzE,0CAEN,OACE,gBAACyH,EAAO,iBACFzH,EAAK,CACTwI,UAAWA,EACXd,MAAOA,EACPO,IAAKC,KAAKD,IACVS,wBAAyB,CAAEC,OAAQF,EAAUnB,EAAcL,OAAOsB,GAAUlB,EAAiBJ,OAAOsB,OAKlG,eACN,GAAIL,KAAKD,IAAIW,QAAS,CACpB,IAAMC,kBAAkBX,KAAKD,IAAIW,SAEjC,MAAMH,EAAUP,KAAKD,IAAIW,QAAQE,qBAAqB,KAEtD,IAAK,IAAIhF,EAAI,EAAGA,EAAI2E,EAAQ5E,OAAQC,GAAK,EAAG,CAC1C,MAAMsD,EAAIqB,EAAQ3E,IACdoE,KAAKlI,MAAM+I,sBAGJ3B,EAAE4B,OAASxI,OAAOyI,SAASD,QADpC5B,EAAE8B,OAAS","file":"templates/default~Users/tainguyen/neo-one/packages/neo-one-website/src/pages/blog~Users/tainguyen/neo-one/pack~6743c146.25c13968.js","sourcesContent":["// tslint:disable no-null-keyword\nimport React from 'react';\nimport { Head } from 'react-static';\n\ninterface Props {\n  readonly title: string;\n  readonly description?: string;\n  readonly children?: React.ReactNode;\n}\n\nexport const Helmet = ({ title, description, children, ...props }: Props) => (\n  <Head\n    title={title}\n    {...props}\n    meta={[\n      { name: 'twitter:title', content: title },\n      // @ts-ignore\n      { itemprop: 'name', content: title },\n      { property: 'og:title', content: title },\n      // @ts-ignore\n      { itemprop: 'image', content: 'https://neo-one.io/social.png' },\n      { name: 'twitter:image:src', content: 'https://neo-one.io/social.png' },\n      { property: 'og:image', content: 'https://neo-one.io/social.png' },\n      { name: 'twitter:card', content: 'summary' },\n      { name: 'twitter:site', content: '@neo_one_suite' },\n      { property: 'og:url', content: 'https://neo-one.io' },\n      { property: 'og:site_name', content: 'NEOâ€¢ONE' },\n      { property: 'og:type', content: 'website' },\n    ].concat(\n      description === undefined\n        ? []\n        : [\n            { name: 'description', content: description },\n            // @ts-ignore\n            { itemprop: 'description', content: description },\n            { property: 'og:description', content: description },\n            { name: 'twitter:description', content: description },\n          ],\n    )}\n  >\n    {children}\n  </Head>\n);\n","// tslint:disable\nimport '../../static/css/prism.css';\nif (typeof window !== 'undefined') {\n  require('clipboard');\n}\n// @ts-ignore\nimport Prism from 'prismjs/components/prism-core';\n// @ts-ignore\nconst _WorkerGlobalScope = typeof WorkerGlobalScope === 'undefined' ? undefined : WorkerGlobalScope;\n// tslint:disable-next-line no-any\nconst _self: any =\n  typeof window !== 'undefined'\n    ? window // if in browser\n    : // @ts-ignore\n    _WorkerGlobalScope !== undefined && self instanceof _WorkerGlobalScope\n    ? self // if in worker\n    : {}; // if in node js\n_self.Prism = Prism;\nimport 'prismjs/plugins/toolbar/prism-toolbar.css';\nimport 'prismjs/plugins/toolbar/prism-toolbar';\nif (typeof window !== 'undefined') {\n  require('prismjs/plugins/copy-to-clipboard/prism-copy-to-clipboard');\n}\n// @ts-ignore\nimport 'prismjs/components/prism-clike';\n// @ts-ignore\nimport 'prismjs/components/prism-javascript';\n// @ts-ignore\nimport 'prismjs/components/prism-markup';\n// @ts-ignore\nimport 'prismjs/components/prism-jsx';\nimport './prismBash';\n\nPrism.languages.typescript = Prism.languages.extend('javascript', {\n  // From JavaScript Prism keyword list and TypeScript language spec: https://github.com/Microsoft/TypeScript/blob/master/doc/spec.md#221-reserved-words\n  keyword: /\\b(?:as|await|break|case|catch|continue|debugger|default|do|else|export|finally|for|from|if|import|in|instanceof|of|return|switch|throw|try|while|with|yield|require)\\b/,\n  keywordBlue: /\\b(?:async|class|const|delete|enum|extends|function|get|implements|interface|let|new|package|private|protected|public|set|static|super|this|typeof|var|module|declare|constructor|namespace|abstract|type|readonly)\\b/,\n  builtin: /\\b(?:string|Function|any|number|boolean|Array|symbol|console|void|null)\\b/,\n});\nPrism.languages.ts = Prism.languages.typescript;\nconst typescript = Prism.util.clone(Prism.languages.typescript);\nPrism.languages.tsx = Prism.languages.extend('jsx', typescript);\n// tslint:enable\n\nexport const PrismSetup = Prism;\n","// tslint:disable\n\nconst slugify = (s: any) => encodeURIComponent(String(s).trim().toLowerCase().replace(/\\s+/g, '-'));\nconst defaults = {\n  includeLevel: [1, 2],\n  containerClass: 'table-of-contents',\n  slugify,\n  markerPattern: /^\\[\\[toc\\]\\]/im,\n  listType: 'ul',\n  format: undefined,\n  forceFullToc: false,\n  subTOC: false,\n  containerHeaderHtml: undefined,\n  containerFooterHtml: undefined,\n  name: 'toc',\n};\n\nexport const markdownTOC = (md: any, o: any) => {\n  const options = Object.assign({}, defaults, o);\n  const name = options.name;\n  const tocRegexp = options.markerPattern;\n  let gstate: any;\n  let seen = 0;\n\n  const open = `${name}_open`;\n  const body = `${name}_body`;\n  const close = `${name}_close`;\n\n  function toc(state: any, silent: any) {\n    var token;\n    var match;\n\n    // Reject if the token does not start with [\n    if (state.src.charCodeAt(state.pos) !== 0x5b /* [ */) {\n      return false;\n    }\n    // Don't run any pairs in validation mode\n    if (silent) {\n      return false;\n    }\n\n    // Detect TOC markdown\n    match = tocRegexp.exec(state.src.substr(state.pos));\n    match = !match\n      ? []\n      : match.filter(function (m: any) {\n          return m;\n        });\n    if (match.length < 1) {\n      return false;\n    }\n\n    gstate = undefined;\n    seen = 0;\n\n    // Build content\n    token = state.push(open, 'toc', 1);\n    token.markup = '[[toc]]';\n    token = state.push(body, '', 0);\n    token = state.push(close, 'toc', -1);\n\n    // Update pos so the parser can continue\n    var newline = state.src.indexOf('\\n', state.pos);\n    if (newline !== -1) {\n      state.pos = newline;\n    } else {\n      state.pos = state.pos + state.posMax + 1;\n    }\n\n    return true;\n  }\n\n  md.renderer.rules[open] = function () {\n    var tocOpenHtml = `<div class=\"${options.containerClass}\">`;\n\n    if (options.containerHeaderHtml) {\n      tocOpenHtml += options.containerHeaderHtml;\n    }\n\n    return tocOpenHtml;\n  };\n\n  md.renderer.rules[close] = function () {\n    var tocFooterHtml = '';\n\n    if (options.containerFooterHtml) {\n      tocFooterHtml = options.containerFooterHtml;\n    }\n\n    return tocFooterHtml + `</div>`;\n  };\n\n  md.renderer.rules[body] = function () {\n    if (options.forceFullToc) {\n      /*\n\n      Renders full TOC even if the hierarchy of headers contains\n      a header greater than the first appearing header\n\n      ## heading 2\n      ### heading 3\n      # heading 1\n\n      Result TOC:\n      - heading 2\n         - heading 3\n      - heading 1\n\n      */\n      var tocBody = '';\n      var pos = 0;\n      var tokenLength = gstate && gstate.tokens && gstate.tokens.length;\n\n      while (pos < tokenLength) {\n        var tocHierarchy = renderChildsTokens(pos, gstate.tokens);\n        pos = tocHierarchy[0];\n        tocBody += tocHierarchy[1];\n      }\n\n      return tocBody;\n    } else {\n      const result = renderChildsTokens(seen, gstate.tokens);\n      seen = result[0] + 1;\n      return result[1];\n    }\n  };\n\n  function renderChildsTokens(pos: any, tokens: any) {\n    var headings = [],\n      buffer = '',\n      currentLevel,\n      subHeadings,\n      size = tokens.length,\n      i = pos;\n    while (i < size) {\n      var token = tokens[i];\n      var heading = tokens[i - 1];\n      var level = token.tag && parseInt(token.tag.substr(1, 1));\n      if (\n        token.type === 'heading_close' &&\n        options.includeLevel.indexOf(level) == -1 &&\n        currentLevel !== undefined &&\n        options.subTOC\n      ) {\n        break;\n      }\n      if (token.type !== 'heading_close' || options.includeLevel.indexOf(level) == -1 || heading.type !== 'inline') {\n        i++;\n        continue; // Skip if not matching criteria\n      }\n      if (!currentLevel) {\n        currentLevel = level; // We init with the first found level\n      } else {\n        if (level > currentLevel) {\n          subHeadings = renderChildsTokens(i, tokens);\n          buffer += subHeadings[1];\n          i = subHeadings[0];\n          continue;\n        }\n        if (level < currentLevel) {\n          // Finishing the sub headings\n          buffer += `</li>`;\n          headings.push(buffer);\n          return [i, `<${options.listType}>${headings.join('')}</${options.listType}>`];\n        }\n        if (level == currentLevel) {\n          // Finishing the sub headings\n          buffer += `</li>`;\n          headings.push(buffer);\n        }\n      }\n      buffer = `<li><a href=\"#${options.slugify(heading.content)}\">`;\n      buffer += typeof options.format === 'function' ? options.format(heading.content) : heading.content;\n      buffer += `</a>`;\n      i++;\n    }\n    buffer += buffer === '' ? '' : `</li>`;\n    headings.push(buffer);\n    return [i, `<${options.listType}>${headings.join('')}</${options.listType}>`];\n  }\n\n  // Catch all the tokens for iteration later\n  md.core.ruler.push('grab_state', function (state: any) {\n    if (gstate === undefined) {\n      gstate = state;\n    }\n  });\n\n  // Insert TOC\n  md.inline.ruler.after('emphasis', 'toc', toc);\n};\n","import { css } from '@emotion/core';\nimport styled from '@emotion/styled';\nimport { prop, switchProp, theme } from '@neo-one/react-common';\nimport MarkdownIt from 'markdown-it';\n// @ts-ignore\n// tslint:disable-next-line: no-submodule-imports\nimport anchor from 'markdown-it-anchor/dist/markdownItAnchor.js';\n// @ts-ignore\nimport container from 'markdown-it-container';\nimport * as React from 'react';\nimport slugify from 'slugify';\nimport { Prism } from '../common';\nimport { markdownTOC } from './markdownTOC';\n\nconst langPrefix = 'language-';\n\nconst createMD = ({ withAnchors }: { readonly withAnchors: boolean }) => {\n  const md = MarkdownIt();\n  md.set({\n    html: false,\n    xhtmlOut: false,\n    breaks: false,\n    langPrefix,\n    linkify: true,\n    typographer: true,\n    quotes: `\"\"''`,\n    highlight: (text, lang) => {\n      const code = md.utils.escapeHtml(text);\n      const classAttribute = lang ? ` class=\"${langPrefix}${lang}\"` : '';\n\n      return `<pre${classAttribute}><code${classAttribute}>${code}</code></pre>`;\n    },\n  })\n    .use(markdownTOC, {\n      slugify,\n      includeLevel: [2],\n      name: 'toc',\n    })\n    .use(markdownTOC, {\n      slugify,\n      markerPattern: /^\\[\\[toc-reference\\]\\]/im,\n      format: (content: string) => md.render(content).slice(3, -5),\n      includeLevel: [4, 5],\n      name: 'toc_reference',\n      subTOC: true,\n    })\n    .use(container, 'warning', {\n      // tslint:disable-next-line:no-any\n      render: (tokens: any, idx: any) => {\n        if (tokens[idx].type === 'container_warning_open') {\n          return '<blockquote class=\"warning\">';\n        }\n\n        return '</blockquote>\\n';\n      },\n    });\n\n  if (withAnchors) {\n    md.use(anchor, {\n      slugify,\n      level: [2, 3, 4, 5],\n    });\n  }\n\n  return md;\n};\n\nconst mdWithoutAnchors = createMD({ withAnchors: false });\nconst mdWithAnchors = createMD({ withAnchors: true });\n\nconst headerMargins = css`\n  margin-top: 32px;\n  margin-bottom: 24px;\n`;\n\n// tslint:disable-next-line no-any\nconst lightCode: any = (props: { readonly theme: typeof theme; readonly light: boolean }) => {\n  if (props.light) {\n    return css`\n      background-color: ${props.theme.gray1};\n      color: ${props.theme.black};\n      padding: 4px;\n      border-radius: 4px;\n    `;\n  }\n\n  return '';\n};\n\nconst stretchCSS = css`\n  margin-left: -24px;\n  margin-right: -24px;\n`;\n\nconst Wrapper = styled.div<{ readonly linkColor: 'primary' | 'gray' | 'accent'; readonly light: boolean }>`\n  ${prop('theme.fontStyles.subheading')};\n  ${prop('theme.fonts.axiformaThin')};\n  overflow-wrap: break-word;\n\n  & h1 {\n    ${prop('theme.fontStyles.display2')};\n    margin-top: 16px;\n    margin-bottom: 24px;\n  }\n\n  & h2 {\n    ${prop('theme.fontStyles.display1')};\n    ${headerMargins};\n  }\n\n  & h3 {\n    ${prop('theme.fontStyles.headline')};\n    ${headerMargins};\n  }\n\n  & h4 {\n    ${prop('theme.fontStyles.subheading')};\n    ${headerMargins};\n  }\n\n  & h5 {\n    ${prop('theme.fontStyles.subheading')};\n    ${headerMargins};\n  }\n\n  & h6 {\n    ${prop('theme.fontStyles.body2')};\n    ${headerMargins};\n  }\n\n  & p {\n    margin-bottom: 16px;\n    margin-top: 16px;\n  }\n\n  & code {\n    ${lightCode};\n    ${prop('theme.fontStyles.subheading')};\n    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;\n    white-space: nowrap;\n  }\n\n  & pre > code {\n    color: inherit;\n    background-color: inherit;\n    white-space: pre;\n  }\n\n  & a {\n    /* stylelint-disable-next-line */\n    color: ${switchProp('linkColor', {\n      primary: prop('theme.primary'),\n      accent: prop('theme.accent'),\n      gray: prop('theme.gray6'),\n    })};\n    ${prop('theme.fonts.axiformaBold')};\n    ${prop('theme.fontStyles.subheading')};\n    text-decoration: none;\n  }\n\n  & a code {\n    /* stylelint-disable-next-line */\n    color: ${switchProp('linkColor', {\n      primary: prop('theme.primary'),\n      accent: prop('theme.accent'),\n      gray: prop('theme.gray6'),\n    })};\n  }\n\n  & a:hover {\n    color: ${prop('theme.primaryDark')};\n    text-decoration: none;\n  }\n\n  & a:hover code {\n    color: ${prop('theme.primaryDark')};\n  }\n\n  & a:focus {\n    color: ${prop('theme.primaryDark')};\n    text-decoration: none;\n  }\n\n  & a:focus code {\n    color: ${prop('theme.primaryDark')};\n  }\n\n  & a:active {\n    color: ${prop('theme.primaryDark')};\n    text-decoration: none;\n  }\n\n  & a:active code {\n    color: ${prop('theme.primaryDark')};\n  }\n\n  & hr {\n    border-bottom: 1px solid rgba(255, 255, 255, 0.075);\n    margin-bottom: 8px;\n    margin-top: 32px;\n  }\n\n  & strong {\n    font-weight: ${prop('theme.fontStyles.axiformaMedium')};\n  }\n\n  & blockquote {\n    border-left: 5px solid rgba(255, 255, 255, 0.12);\n    margin-bottom: 16px;\n    margin-left: 0;\n    margin-right: 24px;\n    margin-top: 16px;\n    padding-left: 16px;\n  }\n\n  & ul {\n    margin-bottom: 8px;\n    margin-top: 8px;\n    padding-left: 24px;\n  }\n\n  & ol {\n    margin-bottom: 8px;\n    margin-top: 8px;\n    padding-left: 24px;\n  }\n\n  & li {\n    margin-top: 8px;\n  }\n\n  & pre {\n    margin-bottom: 16px;\n    margin-top: 16px;\n    white-space: pre-wrap;\n  }\n\n  & .header-anchor {\n    vertical-align: top;\n  }\n\n  & blockquote.warning {\n    background-color: rgba(255, 229, 100, 0.3);\n    border-left-color: #ffe564;\n    border-left-width: 8px;\n    border-left-style: solid;\n    padding: 16px 40px 16px 24px;\n    margin-bottom: 24px;\n    margin-top: 16px;\n    ${stretchCSS};\n  }\n\n  & blockquote.warning p {\n    margin-top: 0;\n    margin-bottom: 0;\n  }\n\n  & blockquote.warning p:first-of-type {\n    ${prop('theme.fonts.axiformaBold')};\n  }\n\n  &&&& img {\n    max-width: 100%;\n  }\n\n  &&&& p img {\n    max-width: 100%;\n  }\n`;\n\ninterface Props {\n  readonly source: string;\n  readonly linkColor?: 'primary' | 'gray' | 'accent';\n  readonly openAllLinksInNewTab?: boolean;\n  readonly light?: boolean;\n  readonly anchors?: boolean;\n  readonly resetScroll?: boolean;\n}\nexport class Markdown extends React.Component<Props> {\n  private readonly ref = React.createRef<HTMLDivElement>();\n\n  public componentDidMount(): void {\n    this.handleUpdate();\n    if (this.props.resetScroll) {\n      window.scrollTo(0, 0);\n    }\n  }\n\n  public componentDidUpdate(prevProps: Props): void {\n    this.handleUpdate();\n    if (this.props.resetScroll && this.props.source !== prevProps.source) {\n      window.scrollTo(0, 0);\n    }\n  }\n\n  public render() {\n    const { source, linkColor = 'primary', light = false, anchors = false, ...props } = this.props;\n\n    return (\n      <Wrapper\n        {...props}\n        linkColor={linkColor}\n        light={light}\n        ref={this.ref}\n        dangerouslySetInnerHTML={{ __html: anchors ? mdWithAnchors.render(source) : mdWithoutAnchors.render(source) }}\n      />\n    );\n  }\n\n  private handleUpdate(): void {\n    if (this.ref.current) {\n      Prism.highlightAllUnder(this.ref.current);\n\n      const anchors = this.ref.current.getElementsByTagName('a');\n      // tslint:disable-next-line no-loop-statement prefer-for-of\n      for (let i = 0; i < anchors.length; i += 1) {\n        const a = anchors[i];\n        if (this.props.openAllLinksInNewTab) {\n          // tslint:disable-next-line no-object-mutation\n          a.target = '_blank';\n        } else if (a.host !== window.location.host) {\n          // tslint:disable-next-line no-object-mutation\n          a.target = '_blank';\n        }\n      }\n    }\n  }\n}\n"],"sourceRoot":""}